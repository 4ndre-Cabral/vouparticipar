(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0fcf":function(t,e,a){"use strict";var s=a("8e2e"),i=a.n(s);i.a},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},6:function(t,e){},7:function(t,e){},8:function(t,e){},"8e2e":function(t,e,a){},9:function(t,e){},e3ba:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("q-page-container",[a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-12 col-md-6"},[a("q-card",{staticClass:"my-card q-mt-sm q-mx-sm",staticStyle:{"max-width":"50em"},attrs:{bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h3"},[t._v("Eleições 2020")])]),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[t._v("\n            Sondagem Eleitoral sem referenciamento científico\n          ")])],1),t.mostrarPerguntas?a("q-list",{staticClass:"my-list q-mt-sm q-mx-sm",staticStyle:{"max-width":"50em"}},t._l(t.questions,(function(e,s){return a("div",{key:e._id},["single_option"===e.type?a("single-option",{attrs:{question:e,index:s},on:{answerUpdate:t.answerUpdate}}):t._e(),"multiple_option"===e.type?a("multiple-option",{attrs:{question:e,index:s},on:{answerUpdate:t.answerUpdate}}):t._e()],1)})),0):a("div",{},[a("img",{staticClass:"q-my-md q-ml-sm",staticStyle:{width:"23em"},attrs:{src:"logo-survey.png",alt:"Vou participar"}}),a("q-item",{attrs:{clickable:"",tag:"a",target:"_blank",href:"https://vouparticipar.com/"}},[a("q-item-section",{attrs:{avatar:""}},[a("img",{staticStyle:{width:"32px"},attrs:{src:"vouparticiparIcon.png"}})]),a("q-item-section",[a("q-item-label",[t._v(" Contato ")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                Clique aqui para mais informações\n              ")])],1)],1)],1),t.mostrarPerguntas&&t.answer.answerQuestions.length>0?a("q-btn",{staticClass:"q-mb-xl q-ml-sm",staticStyle:{background:"goldenrod",color:"white"},attrs:{disable:t.questions.length!==t.answer.answerQuestions.length,label:"Enviar"},on:{click:t.votar}}):t._e()],1)])]),a("q-dialog",{model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"q-pt-xs q-mr-sm",attrs:{id:"logo-fsm"}},[a("img",{staticStyle:{width:"32px"},attrs:{src:"vouparticiparIcon.png"}})]),a("div",{staticClass:"text-h6 q-pt-sm"},[t._v("Obrigado por Participar")])])]),a("q-card-section",{staticClass:"q-pt-none"},[t._v("\n        Seu voto foi computado com sucesso\n      ")]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticStyle:{background:"goldenrod",color:"white"},attrs:{label:"OK"}})],1)],1)],1),a("q-footer",{staticClass:"bg-white text-secondary",attrs:{bordered:""}},[a("q-toolbar",{staticStyle:{display:"block"}},[a("div",{staticClass:"text-caption"},[t._v("\n        * a presente verificação de opinião não se trata de pesquisa eleitoral nos termos da legislação eleitoral\n        - Resolução nr 23.600 de dezembro de 1999, art. 22, §1º, §2º e §3º ,\n        tratando-se tão somente de ferramenta de trabalho para instruir ações específicas de consultoria.\n      ")]),a("div",{staticClass:"text-caption"},[t._v("\n        * a presente verificação de opinião não terá seu resultado divulgado/apresentado em nenhuma hipótese.\n      ")])])],1)],1)},i=[],o=(a("e01a"),a("e6cf"),a("498a"),a("bc3a")),n=a.n(o);const r="https://bi-survey-api.herokuapp.com/surveys";var l={getById(t){const e=`${r}/${t}`;return n.a.get(e)}};const c="https://bi-survey-api.herokuapp.com/answers";var d={getAll(){const t=c+"/";return n.a.get(t)},add(t){const e=""+c;return n.a.post(e,t)},getBySurveyId(t){const e=`${c}/${t}`;return n.a.get(e)},getIfAlredyExist(t){const e=c+"/allByFilter";return n.a.post(e,t)},getUserIp(){return n.a.get("https://www.cloudflare.com/cdn-cgi/trace")}},p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-expansion-item",{class:t.$q.platform.is.desktop?"text-h6":"text-h8",attrs:{popup:"","default-opened":"",disable:"",label:t.index+1+" - "+t.question.description,caption:"Selecione apenas uma opção"}},[a("q-separator"),a("q-card",[a("q-list",{staticClass:"q-pa-md"},t._l(t.question.options,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e._id,attrs:{tag:"label"}},[e.photoUrl?a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{size:"70px"}},[a("img",{attrs:{src:e.photoUrl}})])],1):t._e(),a("q-item-section",{staticClass:"q-mt-md",attrs:{side:"",top:""}},[a("q-radio",{attrs:{label:e.label,val:e._id},nativeOn:{click:function(a){return t.salvarResposta(e)}},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)],1)})),1)],1)],1)],1)},u=[],m={props:["question","index"],data(){return{selected:null}},methods:{salvarResposta(t){const e={question:this.question._id,options:[this.selected]};this.$emit("answerUpdate",e)}}},h=m,q=a("2877"),g=a("3b73"),v=a("eb85"),f=a("f09f"),w=a("1c1c"),b=a("66e5"),Q=a("4074"),y=a("cb32"),x=a("3786"),_=a("714f"),I=a("eebe"),C=a.n(I),k=Object(q["a"])(h,p,u,!1,null,"ec1d8774",null),S=k.exports;C()(k,"components",{QExpansionItem:g["a"],QSeparator:v["a"],QCard:f["a"],QList:w["a"],QItem:b["a"],QItemSection:Q["a"],QAvatar:y["a"],QRadio:x["a"]}),C()(k,"directives",{Ripple:_["a"]});var $=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-expansion-item",{class:t.$q.platform.is.desktop?"text-h6":"text-h8",attrs:{popup:"","default-opened":"",disable:"",label:t.index+1+" - "+t.question.description,caption:"Você pode escolher mais de uma opção"}},[a("q-separator"),a("q-card",[a("q-list",{staticClass:"q-pa-md"},t._l(t.question.options,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e._id,attrs:{tag:"label"}},[e.photoUrl?a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{size:"70px"}},[a("img",{attrs:{src:e.photoUrl}})])],1):t._e(),a("q-item-section",{staticClass:"q-mt-md",attrs:{side:"",top:""}},[a("q-checkbox",{key:e._id,attrs:{label:e.label,val:e._id},nativeOn:{click:function(a){return t.salvarResposta(e)}},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)],1)})),1)],1)],1)],1)},U=[],E={props:["question","index"],data(){return{selected:[]}},methods:{salvarResposta(t){const e={question:this.question._id,options:this.selected};this.$emit("answerUpdate",e)}}},P=E,A=a("8f8e"),O=Object(q["a"])(P,$,U,!1,null,"2c57a490",null),R=O.exports;C()(O,"components",{QExpansionItem:g["a"],QSeparator:v["a"],QCard:f["a"],QList:w["a"],QItem:b["a"],QItemSection:Q["a"],QAvatar:y["a"],QCheckbox:A["a"]}),C()(O,"directives",{Ripple:_["a"]});var j=a("9516"),L=a.n(j),B=a("18d6"),F=a("436b");const{v4:J}=a("e144");var M={name:"PageSurvey",inject:["setTitle"],components:{SingleOption:S,MultipleOption:R},data(){return{title:"",alert:!1,mostrarPerguntas:!1,questions:[],answer:{survey:null,lat:"",lng:"",date:new Date,answerQuestions:[],userIp:"",userId:J()}}},methods:{answerUpdate(t){const e=this.answer.answerQuestions.filter(e=>e.question===t.question);e.length>0?this.answer.answerQuestions.map(e=>{e.question===t.question&&(e.options=t.options)}):this.answer.answerQuestions.push(t)},votar(){this.$q.loading.show(),this.mostrarPerguntas=!1;const t=this;""!==this.answer.lat&&""!==this.answer.lng||(delete this.answer.lat,delete this.answer.lng);const e=new L.a("7qxgQLHYFj4wBYUVXLJdm8Q1AAnoLkU4lQLNEQJR"),a={content:e.encrypt(this.answer)};d.add(a).then(e=>{t.alert=!0,t.$q.loading.hide()}).catch(e=>{console.error(e),t.$q.loading.hide(),t.$q.notify({message:"Algum erro ocorreu durante o processamento da sua resposta.",caption:"Tente novamente mais tarde",color:"negative"})})},parseFormat(t){const e={},a=t.trim();return a.split("\n").forEach((function(t){var a=t.split("=");Object.defineProperty(e,a[0],{value:a[1]})})),e},shuffle(t){var e,a,s=t.length;while(0!==s)a=Math.floor(Math.random()*s),s-=1,e=t[s],t[s]=t[a],t[a]=e;return t}},async beforeMount(){this.$q.loading.show({message:'Carregamento do <b>formulário</b> em progresso.<br/><span class="text-primary">Aguarde...</span>'}),await d.getUserIp().then(t=>{const e=this.parseFormat(t.data);this.answer.userIp=e.ip}),B["a"].getItem("userId")?this.answer.userId=B["a"].getItem("userId"):B["a"].set("userId",this.answer.userId);const t={id:this.$route.params._id,userIp:this.answer.userIp,userId:this.answer.userId};await d.getIfAlredyExist(t).then(t=>{t.data.Answer.length>0?(this.$q.loading.hide(),F["a"].create({title:"Questionário respondido",message:"Esse questionário já foi respondido, obrigado por participar.",cancel:!1,persistent:!0,ok:{color:"primary"}})):this.mostrarPerguntas=!0})},mounted(){if(navigator.geolocation){const t=this;navigator.geolocation.getCurrentPosition((function(e){t.answer.lat=e.coords.latitude,t.answer.lng=e.coords.longitude}))}const t=this;l.getById(this.$route.params._id).then(e=>{t.$q.loading.hide();const a=e.data.Survey;this.setTitle(a.description),a&&a.active?(t.title=a.description,t.answer.survey=a._id,t.questions=t.shuffle(a.questions),t.questions.map(e=>{if(e.lastQuestionId){const a=e.options.filter(t=>t._id===e.lastQuestionId)[0],s=e.options.filter(t=>t._id!==e.lastQuestionId);e.options=t.shuffle(s),e.options.push(a)}else e.options=t.shuffle(e.options);e.answer=null})):(this.mostrarPerguntas=!1,F["a"].create({title:"Questionário inválido",message:"Esse questionário não é mais válido.",cancel:!1,persistent:!0,ok:{color:"primary"}}))})}},N=M,T=(a("0fcf"),a("9989")),z=a("09e3"),V=a("a370"),D=a("0170"),Y=a("9c40"),H=a("24e8"),K=a("4b7e"),X=a("7ff0"),G=a("65c6"),W=a("7f67"),Z=Object(q["a"])(N,s,i,!1,null,"3bbd80ba",null);e["default"]=Z.exports;C()(Z,"components",{QPage:T["a"],QPageContainer:z["a"],QCard:f["a"],QCardSection:V["a"],QSeparator:v["a"],QList:w["a"],QItem:b["a"],QItemSection:Q["a"],QItemLabel:D["a"],QBtn:Y["a"],QDialog:H["a"],QCardActions:K["a"],QFooter:X["a"],QToolbar:G["a"]}),C()(Z,"directives",{ClosePopup:W["a"]})}}]);